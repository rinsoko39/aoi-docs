# 1.2 复合类型

Aoi 有如下基本的复合类型。

## 范围

范围的类型名是 `Range`。`from..to` 表示从 `from` 到 `to` 的左闭右开的范围。它是一个可迭代对象。

## 元组

元组是 Aoi 中十分重要的类型。它表示两个及更多个值的排列。

元组是值类型。

形如 `(Type0, Type1, ...)`，用括号包围的逗号隔开的若干个类型表示一个元组类型。例如，`(int, double)`。

形如 `(value0, value1, ...)`，用括号包裹的逗号隔开的若干个表达式表示一个对应类型的元组。例如，`(42, 4.2)` 表示一个 `(int, double)` 类型的元组。

用 `.` 和数字访问元组中的元素。例如 `tuple.0` 表示元组 `tuple` 中第一个元素。注意不能使用表达式的值访问元组中的元素，如 `tuple.(1+1)`。如需要，请考虑使用数组。

`()` 是一个特殊的元组，表示 0 个元素的元组。它十分重要，例如可以用返回值为 `()` 表示运算符没有返回值。

## 数组

数组存储若干个类型相同的值。`arr[Type]` 表示存储 `type` 类型的数组。例如，`arr[int]`。

数组是引用类型。

---

用 `new` 表达式新建一个数组实例，语法如下：

```aoi
new arr[Type] { element0 ; repeat0, element1 ; repeat1, ... }
```

其中，`arr[Type]` 是数组类型，`element` 是数组元素，`repeat` 是 `int` 类型的表达式，标记这个元素重复多少次，`; repeat` 可选，默认重复一次。有多少个元素就新建长度为多少的数组。

Aoi 中没有默认值，但如果不得不暂时不为数组某些元素赋值，请使用 `unset`，详见类与结构体中对 `unset` 的介绍。

---

用 `instance.[i]` 访问数组实例 `instance` 中的第 `i` 个元素，其中 `i` 是 `int` 类型的表达式。使用 `.[]` 而非 `[]` 一是为防止与泛型混淆，二是能明确这是实例的字段或属性，同时也使 `?.` 的使用更加合理。

用 `instance.[range]` 获取数组实例 `instance` 在 `range` 范围的切片。它返回一个 `Span[Type]`，其中 `Type` 是元素类型，表示数组的切片。`Span` 拥有和数组一样的操作，例如使用索引获取和修改元素。

---

用 `set` 表达式批量修改一个数组实例，语法如下：

```
set instance { element00 ; repeat00, element01 ; repeat01, ..., [index0]: element10 ; repeat10, [index1]: element11 ; repeat11, ... }
```

其中，`instance` 是数组实例，`element` 是要设置的新元素，`index` 是索引，`repeat` 是 `int` 类型的表达式，表示重复次数，`; repeat` 可选，默认重复一次。以上表达式分别将前 `repeat00` 个元素设为 `element00`，之后的 `repeat01` 个元素设为 `element11`，以此类推。同时，将索引为 `index0` 及其之后共`repeat10` 个元素设为 `element10`，`index1` 及其之后共 `repeat11` 个设为 `element11`，以此类推。

在 `set` 中设置重复次数可能不太实用，但是实现起来比较简单，同时和 `new` 语句保持一致，因此将其保留。

`set` 表达式返回数组本身。
