# 2.2 基本运算符

运算符是 Aoi 的核心。Aoi 的运算符分为二元运算符和一元运算符。二元运算符为中缀，一元运算符为前缀。

基本运算符是 `+` `-` 等是符号的运算符。除此之外，还有自定义的是标识符的运算符，以及运用闭包等特性的是表达式的运算符，例如 `(if condition then + else -)`。

## 二元运算符

二元运算符左结合，并区分优先级，优先级越高越优先运算。

运算符 | 描述 | 适用类型 | 优先级
|-|-|-|-|
其它 | 非基本的运算符 | - | 13
`..` | 范围操作符 | `int` | 12
`@` | 预留供自定义 | - | 11
`*` | 乘法 | `int` `float` | 11
`/` | 除法 | `int` `float` | 11
`%` | 取余 | `int` `float` | 11
`+` | 加法、字符串拼接 | `int` `float` `str`、`char` 和 `int` | 10
`-` | 减法 | `int` `float`、`char` 和 `int` | 10
`<<` | 左移 | `int` | 9
`>>` | 右移 | `int` | 9
`<` | 小于 | `int` `float` `char` | 8
`<=` | 小于等于 | `int` `float` `char` | 8
`>` | 大于 | `int` `float` `char` | 8
`>=` | 大于等于 | `int` `float` `char` | 8
`==` | 等于 | 所有类型 | 8
`!=` | 不等于 | 所有类型 | 8
`&` | 按位或、非短路的逻辑或 | `int` `bool` | 7
`^` | 异或 | `int` `bool` | 6
`\|` | 按位与、非短路的逻辑与 | `int` `bool` | 5
`&&` | 短路的逻辑与 | `bool` | 4
`\|\|` | 短路的逻辑或 | `bool` | 3
`??` | 空值合并 | `T?`、`T?` 与 `T`（`T` 为任意类型） | 2
`\|>` | 管道操作 | `T` 与 `T -> U`（`T` `U` 为任意类型） | 1

例如，若自定义了 `operate` 运算符，则 `1 + 2 * 3 operate 4..5` 的计算顺序为 `1 + (2 * (3 operate (4..5)))`。不过，实际情况下出现多种运算符建议添加括号。

非基本运算符优先级最高，主要考虑到应用时大多类似于其它语言的方法调用，例如，Aoi 中可以用 `list insert a` 来实现其它语言中 `list.insert(a)` 的功能，因此将其优先级定为最高，与方法调用优先级一致。

## 一元运算符

一元运算符的优先级高于二元运算符。

运算符 | 描述 | 适用类型
|-|-|-|
其它 | 非基本的运算符 | -
`@` | 预留供自定义 | -
`+` | 正号 | `int` `float`
`-` | 负号 | `int` `float`
`!` | 逻辑非 | `bool`
`~` | 按位非 | `bool`

## 非符号运算符的识别

形如 `a b c d` 的表达式由于解析阶段不能确认哪些是运算符哪些是值，将会按以下规则识别：

- 若为一个表达式，那它就是一个表达式。
- 若为两个表达式，则识别为一元运算符。例如 `a b` 被识别为运算符 `a` 作用于 `b`。
- 若为两个以上的奇数个表达式，则识别为若干个二元运算符。例如，`a b c d e` 中，`b` `d` 被识别为二元运算符。它们将会左结合地运算。
- 若为两个以上的偶数个表达式，则解析不通过。

为避免混乱，应尽量使用括号明确语义。
